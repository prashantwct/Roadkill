{% extends "base.html" %}
{% block content %}

<h2>User Management</h2>

<table border="1" cellpadding="6" cellspacing="0">
  <thead>
    <tr style="background:#f0f0f0;">
      <th>Username</th>
      <th>Full Name</th>
      <th>Role</th>
      <th>Status</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
  {% for u in users %}
    <tr>
      <td>{{ u.username }}</td>
      <td>{{ u.full_name or '—' }}</td>
      <td>{{ u.role }}</td>
      <td>
        {% if u.is_approved %}
          ✅ Approved
        {% else %}
          ⏳ Pending
        {% endif %}
      </td>
      <td>
        {% if not u.is_approved %}
          <a href="{{ url_for('approve_user', user_id=u.id) }}">Approve</a> |
        {% endif %}
        
        <form method="POST" action="{{ url_for('reset_user_password', user_id=u.id) }}" style="display:inline;">
          <input type="password" name="new_password" placeholder="New password" required>
          <button type="submit">Reset</button>
        </form>
        
        {% if u.username != 'admin' %}
          | <a href="{{ url_for('delete_user', user_id=u.id) }}" onclick="return confirm('Delete this user?');">Delete</a>
        {% endif %}
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>

<p><a href="{{ url_for('admin_dashboard') }}">← Back to Dashboard</a></p>

<style>
table {
  border-collapse: collapse;
  width: 100%;
}
th, td {
  text-align: left;
}
input[type="password"] {
  width: 120px;
  padding: 3px;
  margin-right: 5px;
}
button {
  background: #4CAF50;
  color: white;
  border: none;
  padding: 4px 8px;
  border-radius: 4px;
  cursor: pointer;
}
button:hover {
  background: #45a049;
}
</style>

{% endblock %}
